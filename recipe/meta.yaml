{% set version = "225" %}

package:
  name: pywin32
  version: {{ version }}

source:
  url: https://github.com/mhammond/pywin32/archive/b{{ version }}.tar.gz
  sha256: ec164d85a563189725ecaadba735f6fc207e4b47213d20923c149f001a6bc102

build:
  number: 0
  script:
    - pushd "{{ RECIPE_DIR }}"
    - cp disable_exchange_modules.patch "{{ SRC_DIR }}"
    - popd
    - patch --binary -p1 -i disable_exchange_modules.patch
    - "{{ PYTHON }} setup.py -q install --record=record.txt"
    - copy %PREFIX%\Lib\site-packages\pywin32_system32\*.dll %LIBRARY_BIN%
  skip: True  # [not win or py27]

requirements:
  build:
    - {{ compiler("c") }}
    - patch
  host:
    - python
    - pip
  run:
    - python

about:
  home: https://github.com/mhammond/pywin32
  license: PSF
  summary: Python extensions for Windows

extra:
  recipe-maintainers:
    - nicoddemus
    - carlodri
